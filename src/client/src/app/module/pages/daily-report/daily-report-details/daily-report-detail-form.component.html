<mat-toolbar class="grid-toolbar box-shadow" role="heading">
    <span class="grid-title" [innerHTML]="formTitle()"></span>
    <div class="right-side">
        <!--close button-->
        <button mat-icon-button
                *ngIf="!entityService.isEditing && !sharedService.isHandset"
                [matTooltip]="uiConfig.labels.closeFormPanel"
                (click)='toggleShowPanel()'>
            <mat-icon>close</mat-icon>
        </button>
    </div>
</mat-toolbar>
<div class="form-body box-shadow">
    <mat-spinner [style.visibility]="working?'visible':'hidden'" diameter="20">
    </mat-spinner>

    <mat-card-content>

        <mat-form-field>
            <mat-label>{{uiConfig.labels.specific['status']}}</mat-label>
            <input matInput autocomplete="off" [disabled]="!entityService.isEditing" [(ngModel)]="item['status']" (blur)="save()"/>
            <div class="form-field-error" *ngIf="errors['status']">
                <p *ngFor="let msg of errors['status']">{{msg}}</p>
            </div>
        </mat-form-field>
        <mat-form-field>
            <mat-label>{{uiConfig.labels.specific['percent']}}</mat-label>
            <input matInput autocomplete="off" [disabled]="!entityService.isEditing" [(ngModel)]="item['percent']" (blur)="save()"/>
            <div class="form-field-error" *ngIf="errors['percent']">
                <p *ngFor="let msg of errors['percent']">{{msg}}</p>
            </div>
        </mat-form-field>
        <mat-form-field>
            <mat-label>{{uiConfig.labels.specific['taiga']}}</mat-label>
            <input matInput autocomplete="off" [disabled]="!entityService.isEditing" [(ngModel)]="item['taiga']" (blur)="save()"/>
            <div class="form-field-error" *ngIf="errors['taiga']">
                <p *ngFor="let msg of errors['taiga']">{{msg}}</p>
            </div>
        </mat-form-field>
        <mat-form-field>
            <mat-label>{{uiConfig.labels.specific['subsection']}}</mat-label>
            <input matInput autocomplete="off" [disabled]="!entityService.isEditing" [(ngModel)]="item['subsection']" (blur)="save()"/>
            <div class="form-field-error" *ngIf="errors['subsection']">
                <p *ngFor="let msg of errors['subsection']">{{msg}}</p>
            </div>
        </mat-form-field>
        <mat-form-field>
            <mat-label>{{uiConfig.labels.specific['description']}}</mat-label>
            <textarea matInput matAutosizeMaxRows="4" autocomplete="off" matTextareaAutosize="true"
                      [disabled]="!entityService.isEditing" [(ngModel)]="item['description']" (blur)="save()"></textarea>
            <div class="form-field-error" *ngIf="errors['description']">
                <p *ngFor="let msg of errors['description']">{{msg}}</p>
            </div>
        </mat-form-field>
        <div *ngIf="errorMessages.length" class="errors">
            <ul class="ui-corner-all">
                <li *ngFor="let message of errorMessages">{{message}}</li>
            </ul>
        </div>
        <div *ngIf="successMessages.length" class="success">
            <ul class="ui-corner-all">
                <li *ngFor="let message of successMessages">{{message}}</li>
            </ul>
        </div>
    </mat-card-content>
    <mat-toolbar class="grid-toolbar" role="footer">
        {{uiConfig.labels.itemDetails}}
        <div class="right-side">
            <!--add button-->
            <button mat-icon-button
                    *ngIf="!entityService.isEditing || !remote"
                    color="primary"
                    (click)='newItem()'>
                <mat-icon>add</mat-icon>
            </button>
            <!--modify button-->
            <button mat-icon-button
                    *ngIf="!entityService.isEditing && remote"
                    [disabled]="!hasItem"
                    color="primary"
                    (click)='modify()'>
                <mat-icon>edit</mat-icon>
            </button>
            <!--delete button-->
            <div *ngIf="!entityService.isEditing || !remote" style="display: inline-block">
                <mat-menu #deleteMenu="matMenu">
                    <div style="display: flex;flex-direction: column;margin:0 10px">
                        <button mat-flat-button
                                style="margin-bottom: 5px;"
                                color="primary">Cancel
                        </button>
                        <button mat-flat-button
                                (click)='delete(item)' color="warn">
                            <mat-icon>check</mat-icon>
                            Confirm
                        </button>
                    </div>
                </mat-menu>
                <button mat-icon-button
                        [matMenuTriggerFor]="deleteMenu"
                        color="warn"
                        [disabled]="!hasItem">
                    <mat-icon>delete</mat-icon>
                </button>
            </div>
            <!--navigation buttons-->
            <div *ngIf="showNavigation" class="navigation-btns">
                <button mat-icon-button
                        [disabled]="service.data.isFirst"
                        (click)='service.data.first()'>
                    <mat-icon>skip_previous</mat-icon>
                </button>
                <button mat-icon-button
                        [disabled]="service.data.isFirst"
                        (click)='service.data.previous()'>
                    <mat-icon>navigate_before</mat-icon>
                </button>
                <button mat-icon-button
                        [disabled]="service.data.isLast"
                        (click)='service.data.next()'>
                    <mat-icon>navigate_next</mat-icon>
                </button>
                <button mat-icon-button
                        [disabled]="service.data.isLast"
                        (click)='service.data.last()'>
                    <mat-icon>skip_next</mat-icon>
                </button>
            </div>
            <!--save button-->
            <button mat-flat-button
                    color="accent"
                    *ngIf="entityService.isEditing && remote"
                    (click)='save()'>
                <mat-icon>check</mat-icon>
                {{uiConfig.labels.save}}
            </button>
            <!--cancel button-->
            <button mat-flat-button
                    color="warn"
                    *ngIf="entityService.isEditing && remote"
                    (click)='cancel()'>
                <mat-icon>cancel</mat-icon>
                {{uiConfig.labels.cancel}}
            </button>
        </div>
    </mat-toolbar>
</div>
